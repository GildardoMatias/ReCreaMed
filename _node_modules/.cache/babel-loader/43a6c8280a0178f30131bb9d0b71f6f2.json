{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Table,Button,Modal}from'antd';import{Form,Select}from'antd';import{getData,usuario,sendDataBody,ids_hospitales}from'../../../resources';import EscalasCreateGeneralLink from'../../escalasCreateGeneralLink';import getAllEscalas from'../../getEscalas';import Loading from'../../../loading';import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const{Option}=Select;// DEPRESION QIDS \nexport default function DepresionResults(){const[encuestasData,setEncuestasData]=useState([]);const[medicosData,setMedicosData]=useState([]);const[countersData,setCountersData]=useState([]);const[loading,setLoading]=useState(true);// For Modal\nconst[isModalOpen,setIsModalOpen]=useState(false);const showModal=()=>{setIsModalOpen(true);};const handleOk=()=>{setIsModalOpen(false);};const handleCancel=()=>{setIsModalOpen(false);};useEffect(()=>{usuario.rol==='Administrador'||usuario.rol==='Recepcion'||usuario.rol==='Enfermero'?getAllEscalas('depresion',setEncuestasData,setLoading):getEncuestasData(usuario._id);},[]);const getEncuestasData=medico=>{getData(\"encuestas/depresion/medico/\".concat(medico)).then(rs=>{// getCounters(rs, medico);\nconsole.log(rs);setEncuestasData(rs);}).finally(()=>setLoading(false));};const getCounters=(data,medico)=>{const allEncuestas=[...data];const results=[];getData(\"mispacientes/\".concat(medico)).then(rs=>{rs.forEach(pac=>{const aprs=allEncuestas.filter(enc=>{var _enc$usuario;return((_enc$usuario=enc.usuario)===null||_enc$usuario===void 0?void 0:_enc$usuario._id)===pac._id;});const latest=aprs.at(-1);results.push({'paciente':pac.name,'total':aprs.length,'semana':latest===null||latest===void 0?void 0:latest.createdAt.substring(0,10)});});console.log(results);}).finally(()=>{setCountersData(results);});};const counterColumns=[{title:'Paciente',key:'paciente',dataIndex:'paciente'},{title:'Fecha ultima encuesta',key:'semana',dataIndex:'semana'},{title:'Total Escalas Respondidas',key:'total',dataIndex:'total'}];const columns=[{title:'Paciente',dataIndex:'usuario',key:'name',render:(_,_ref)=>{let{usuario}=_ref;return/*#__PURE__*/_jsx(_Fragment,{children:usuario?usuario.name:\"Usuario eliminado\"});}},{title:'Puntaje',dataIndex:'score',key:'age'}];if(loading)return/*#__PURE__*/_jsx(Loading,{});return/*#__PURE__*/_jsxs(\"div\",{className:\"mainContainer\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Resultados de encuestas de sintomatologia depresiva QUIDS (QUICK INVENTORY OF DEPRESSIVE SYMPTOMATOLOGY)\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:showModal,children:\"Generar Escala Depresion 1\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h4\",{children:\"Detalles de encuestas\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Table,{dataSource:encuestasData,columns:columns,bordered:true}),/*#__PURE__*/_jsx(Modal,{title:\"Crear encuesta de Depresion QUIDS\",open:isModalOpen,onOk:handleOk,onCancel:handleCancel,footer:[/*#__PURE__*/_jsx(Button,{onClick:handleCancel,children:\"Cerrar\"})],children:/*#__PURE__*/_jsx(EscalasCreateGeneralLink,{tipo:\"depresion_qids\"})})]});}","map":{"version":3,"names":["React","useState","useEffect","Table","Button","Modal","Form","Select","getData","usuario","sendDataBody","ids_hospitales","EscalasCreateGeneralLink","getAllEscalas","Loading","Fragment","_Fragment","jsx","_jsx","jsxs","_jsxs","Option","DepresionResults","encuestasData","setEncuestasData","medicosData","setMedicosData","countersData","setCountersData","loading","setLoading","isModalOpen","setIsModalOpen","showModal","handleOk","handleCancel","rol","getEncuestasData","_id","medico","concat","then","rs","console","log","finally","getCounters","data","allEncuestas","results","forEach","pac","aprs","filter","enc","_enc$usuario","latest","at","push","name","length","createdAt","substring","counterColumns","title","key","dataIndex","columns","render","_","_ref","children","className","type","onClick","dataSource","bordered","open","onOk","onCancel","footer","tipo"],"sources":["C:/Users/Gil/Documents/ReCreaMed/src/escalas/depresion/depresion_1/depresionResults.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { Table, Button, Modal } from 'antd'\r\nimport { Form, Select } from 'antd';\r\nimport { getData, usuario, sendDataBody, ids_hospitales } from '../../../resources';\r\nimport EscalasCreateGeneralLink from '../../escalasCreateGeneralLink';\r\nimport getAllEscalas from '../../getEscalas';\r\nimport Loading from '../../../loading';\r\nconst { Option } = Select;\r\n\r\n// DEPRESION QIDS \r\n\r\nexport default function DepresionResults() {\r\n    const [encuestasData, setEncuestasData] = useState([])\r\n    const [medicosData, setMedicosData] = useState([])\r\n    const [countersData, setCountersData] = useState([])\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    // For Modal\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n    const showModal = () => { setIsModalOpen(true) };\r\n    const handleOk = () => { setIsModalOpen(false) };\r\n    const handleCancel = () => { setIsModalOpen(false) };\r\n\r\n    useEffect(() => {\r\n        (usuario.rol === 'Administrador' || usuario.rol === 'Recepcion' || usuario.rol === 'Enfermero') ? getAllEscalas('depresion', setEncuestasData, setLoading) : getEncuestasData(usuario._id)\r\n    }, [])\r\n\r\n\r\n    const getEncuestasData = (medico) => {\r\n        getData(`encuestas/depresion/medico/${medico}`).then((rs) => {\r\n            // getCounters(rs, medico);\r\n            console.log(rs);\r\n            setEncuestasData(rs)\r\n        }).finally(() => setLoading(false))\r\n    }\r\n\r\n    const getCounters = (data, medico) => {\r\n        const allEncuestas = [...data];\r\n        const results = []\r\n        getData(`mispacientes/${medico}`).then(rs => {\r\n            rs.forEach(pac => {\r\n                const aprs = allEncuestas.filter(enc => enc.usuario?._id === pac._id)\r\n                const latest = aprs.at(-1)\r\n                results.push({\r\n                    'paciente': pac.name,\r\n                    'total': aprs.length,\r\n                    'semana': latest?.createdAt.substring(0, 10)\r\n                })\r\n            });\r\n            console.log(results)\r\n        }).finally(() => { setCountersData(results); });\r\n    }\r\n    const counterColumns = [\r\n        {\r\n            title: 'Paciente',\r\n            key: 'paciente',\r\n            dataIndex: 'paciente',\r\n        },\r\n        {\r\n            title: 'Fecha ultima encuesta',\r\n            key: 'semana',\r\n            dataIndex: 'semana',\r\n        },\r\n        {\r\n            title: 'Total Escalas Respondidas',\r\n            key: 'total',\r\n            dataIndex: 'total'\r\n        }\r\n    ];\r\n\r\n\r\n    const columns = [\r\n        {\r\n            title: 'Paciente',\r\n            dataIndex: 'usuario',\r\n            key: 'name',\r\n            render: (_, { usuario }) => <>{usuario ? usuario.name : \"Usuario eliminado\"}</>\r\n        },\r\n        {\r\n            title: 'Puntaje',\r\n            dataIndex: 'score',\r\n            key: 'age',\r\n        }\r\n    ];\r\n\r\n    if (loading) return <Loading />\r\n\r\n    return (\r\n        <div className='mainContainer'>\r\n            <h5>Resultados de encuestas de sintomatologia depresiva QUIDS (QUICK INVENTORY OF DEPRESSIVE SYMPTOMATOLOGY)</h5>\r\n            <br />\r\n            <Button type=\"primary\" onClick={showModal}>\r\n                Generar Escala Depresion 1\r\n            </Button>\r\n\r\n            <br /><br />\r\n\r\n            {/* Counters <Table dataSource={countersData} columns={counterColumns} bordered /> <br /> */}\r\n\r\n            <h4>Detalles de encuestas</h4>\r\n            <br />\r\n            <Table dataSource={encuestasData} columns={columns} bordered />\r\n\r\n            <Modal title=\"Crear encuesta de Depresion QUIDS\" open={isModalOpen} onOk={handleOk} onCancel={handleCancel}\r\n                footer={[\r\n                    <Button onClick={handleCancel}>Cerrar</Button>\r\n                ]}>\r\n                <EscalasCreateGeneralLink tipo='depresion_qids' />\r\n            </Modal>\r\n        </div>\r\n    )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}