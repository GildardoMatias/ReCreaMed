{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Gil\\\\Documents\\\\ReCreaMed\\\\src\\\\doctorViews\\\\expedientes\\\\lastCita.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { getData, updateData } from '../../resources';\nimport { Card, Typography } from 'antd';\nimport { CalendarOutlined, ClockCircleOutlined, DollarOutlined } from '@ant-design/icons';\nimport HistorialCitas from './historialCitas';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  Paragraph\n} = Typography;\nexport default function LastCita(props) {\n  _s();\n  const [cita, setCita] = useState({});\n  const [citasData, setCitasData] = useState({});\n  const [lastBalance, setLastBalance] = useState([]);\n  // const [editableStr, setEditableStr] = useState('Sin costo registrado');\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    getCitasData();\n  }, []);\n  const updateLastBalance = newMonto => {\n    let newLastBalance = lastBalance;\n    newLastBalance.monto = newMonto;\n    updateData(`balances/update/${lastBalance._id}`, newLastBalance).then(getCitasData);\n  };\n  const getLastCta = eventos => {\n    var fechaActual = new Date();\n\n    // Filtrar los eventos que tienen una fecha menor o igual a la fecha actual\n    var eventosPasados = eventos.filter(function (evento) {\n      var fechaEvento = new Date(evento.fecha_hora);\n      return fechaEvento <= fechaActual;\n    });\n\n    // Ordenar los eventos pasados por fecha de forma descendente\n    eventosPasados.sort(function (a, b) {\n      var fechaA = new Date(a.fecha_hora);\n      var fechaB = new Date(b.fecha_hora);\n      return fechaB - fechaA;\n    });\n\n    // Obtener el evento más reciente\n    return eventosPasados[0];\n  };\n  const getCitasData = () => {\n    getData(`citas/${props.paciente}`).then(rs => {\n      const ultimaCita = getLastCta(rs);\n      // console.log('lsat cita', ultimaCita)\n      setCita(ultimaCita);\n      setCitasData(rs);\n      return ultimaCita;\n    }).then(last => {\n      return getData('balances/cita/' + (last === null || last === void 0 ? void 0 : last._id));\n    }).then(bl => {\n      // console.log('balance', bl)\n      setLastBalance(bl[0]);\n    }).finally(() => setLoading(false));\n  };\n  const LastBalance = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: lastBalance && lastBalance.monto ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            flexDirection: 'row',\n            alignItems: 'center',\n            columnGap: '10px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(DollarOutlined, {\n            style: {}\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 33\n          }, this), \"Costo:\", /*#__PURE__*/_jsxDEV(Paragraph, {\n            style: {\n              marginTop: 14\n            },\n            editable: {\n              onChange: updateLastBalance\n            },\n            children: lastBalance.monto\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(HistorialCitas, {\n          historial: citasData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Sin Ultimo Balance\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 25\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 16\n    }, this);\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Cargando...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 25\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginTop: 8\n    },\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      children: cita ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n          children: \"Cita m\\xE1s reciente\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"btnIconCentered\",\n            children: [/*#__PURE__*/_jsxDEV(CalendarOutlined, {\n              style: {\n                marginRight: 8\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 61\n            }, this), \" Fecha: \", new Date(cita.fecha_hora).toLocaleDateString()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 169\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"btnIconCentered\",\n            children: [/*#__PURE__*/_jsxDEV(ClockCircleOutlined, {\n              style: {\n                marginRight: 8\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 106,\n              columnNumber: 61\n            }, this), \" Hora: \", cita.fecha_hora.substring(11, 16)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(LastBalance, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 28\n      }, this) : /*#__PURE__*/_jsxDEV(\"h6\", {\n        children: \"Sin cita recente registrada\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 30\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 9\n  }, this);\n}\n_s(LastCita, \"eKtb3iBsX+qyuWF85d1gjIe14Ms=\");\n_c = LastCita;\nvar _c;\n$RefreshReg$(_c, \"LastCita\");","map":{"version":3,"names":["React","useEffect","useState","getData","updateData","Card","Typography","CalendarOutlined","ClockCircleOutlined","DollarOutlined","HistorialCitas","jsxDEV","_jsxDEV","Paragraph","LastCita","props","_s","cita","setCita","citasData","setCitasData","lastBalance","setLastBalance","loading","setLoading","getCitasData","updateLastBalance","newMonto","newLastBalance","monto","_id","then","getLastCta","eventos","fechaActual","Date","eventosPasados","filter","evento","fechaEvento","fecha_hora","sort","a","b","fechaA","fechaB","paciente","rs","ultimaCita","last","bl","finally","LastBalance","children","style","display","flexDirection","alignItems","columnGap","fileName","_jsxFileName","lineNumber","columnNumber","marginTop","editable","onChange","historial","className","marginRight","toLocaleDateString","substring","_c","$RefreshReg$"],"sources":["C:/Users/Gil/Documents/ReCreaMed/src/doctorViews/expedientes/lastCita.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { getData, updateData } from '../../resources'\r\nimport { Card, Typography } from 'antd'\r\nimport { CalendarOutlined, ClockCircleOutlined, DollarOutlined } from '@ant-design/icons'\r\nimport HistorialCitas from './historialCitas';\r\nconst { Paragraph } = Typography;\r\n\r\n\r\nexport default function LastCita(props) {\r\n\r\n    const [cita, setCita] = useState({})\r\n    const [citasData, setCitasData] = useState({})\r\n    const [lastBalance, setLastBalance] = useState([])\r\n    // const [editableStr, setEditableStr] = useState('Sin costo registrado');\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    useEffect(() => { getCitasData() }, [])\r\n\r\n    const updateLastBalance = (newMonto) => {\r\n\r\n        let newLastBalance = lastBalance;\r\n        newLastBalance.monto = newMonto;\r\n        updateData(`balances/update/${lastBalance._id}`, newLastBalance).then(getCitasData)\r\n    }\r\n\r\n    const getLastCta = (eventos) => {\r\n        var fechaActual = new Date();\r\n\r\n        // Filtrar los eventos que tienen una fecha menor o igual a la fecha actual\r\n        var eventosPasados = eventos.filter(function (evento) {\r\n            var fechaEvento = new Date(evento.fecha_hora);\r\n            return fechaEvento <= fechaActual;\r\n        });\r\n\r\n        // Ordenar los eventos pasados por fecha de forma descendente\r\n        eventosPasados.sort(function (a, b) {\r\n            var fechaA = new Date(a.fecha_hora);\r\n            var fechaB = new Date(b.fecha_hora);\r\n            return fechaB - fechaA;\r\n        });\r\n\r\n        // Obtener el evento más reciente\r\n        return eventosPasados[0]\r\n    }\r\n\r\n    const getCitasData = () => {\r\n        getData(`citas/${props.paciente}`).then((rs) => {\r\n            const ultimaCita = getLastCta(rs);\r\n            // console.log('lsat cita', ultimaCita)\r\n            setCita(ultimaCita)\r\n            setCitasData(rs)\r\n            return ultimaCita\r\n        }).then((last) => {\r\n            return getData('balances/cita/' + last?._id)\r\n        }).then((bl) => {\r\n            // console.log('balance', bl)\r\n            setLastBalance(bl[0])\r\n        }).finally(() => setLoading(false))\r\n    }\r\n\r\n    const LastBalance = () => {\r\n        return <div>\r\n            {\r\n                lastBalance && lastBalance.monto ?\r\n                    (\r\n                        <div >\r\n\r\n                            <div style={{ display: 'flex', flexDirection: 'row', alignItems: 'center', columnGap: '10px' }}>\r\n                                <DollarOutlined style={{}} />\r\n                                Costo:\r\n                                <Paragraph\r\n                                    style={{ marginTop: 14 }}\r\n                                    editable={{\r\n                                        onChange: updateLastBalance,\r\n                                    }}\r\n                                >\r\n                                    {lastBalance.monto}\r\n                                </Paragraph>\r\n\r\n\r\n                            </div>\r\n                            <HistorialCitas historial={citasData} />\r\n                            {/* <div style={{ display: 'flex', flexDirection: 'row', alignItems: 'center', columnGap: '10px' }}>\r\n                             <CalendarOutlined /> {new Date(lastBalance.createdAt).toLocaleDateString()}\r\n                         </div> */}\r\n                        </div>\r\n                    ) : (\r\n                        <p>Sin Ultimo Balance</p>\r\n                    )\r\n            }\r\n\r\n        </div>\r\n    }\r\n\r\n\r\n    if (loading) return <p>Cargando...</p>\r\n    return (\r\n        <div style={{ marginTop: 8 }}>\r\n            <Card>\r\n                {\r\n                    cita ? <div>\r\n                        <h6>Cita más reciente</h6>\r\n                        <ul>\r\n                            <li className='btnIconCentered'><CalendarOutlined style={{ marginRight: 8 }} /> Fecha: {new Date(cita.fecha_hora).toLocaleDateString()}</li><br />\r\n\r\n                            <li className='btnIconCentered'><ClockCircleOutlined style={{ marginRight: 8 }} /> Hora: {cita.fecha_hora.substring(11, 16)}</li>\r\n\r\n                            <LastBalance />\r\n\r\n                        </ul>\r\n                    </div> : <h6>Sin cita recente registrada</h6>\r\n                }\r\n\r\n            </Card>\r\n        </div>\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}